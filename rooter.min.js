(function(){var e,t,n,r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e={lastHash:null,listeners:[],listen:function(e){return n.hash.listeners.push(e)},trigger:function(e){var t,r,i,s;e==null&&(e=n.hash.value()),n.hash.lastHash=e,s=n.hash.listeners;for(r=0,i=s.length;r<i;r++)t=s[r],t(e)},value:function(t){return t&&(window.location.hash=t),e=window.location.hash.replace("#",""),e===""&&(e="/"),e}},t={},i(t,e),t.value=function(e){return e&&(n.hash.lastHash=e,window.location.hash=e),window.location.hash.replace("#","")},t.check=function(){var e;e=n.hash.value(),e!==n.hash.lastHash&&n.hash.trigger(e),setTimeout(n.hash.check,100)},n={lastMatch:null,routes:[],route:function(e,t){var r,i,s;return s="^"+e+"$",s=s.replace(/([?=,\/])/g,"\\$1").replace(/:([\w\d]+)/g,"([^/]*)"),i={route:e,names:e.match(/:([\w\d]+)/g),pattern:RegExp(s),fn:t},n.routes.push(i),r=n.hash.value(),n.isMatch(r,i)&&n.triggerMatch(r,i),n},isMatch:function(e,t){return t.pattern.exec(e)!=null},triggerMatch:function(e,t){var r,i,s,o,u,a,f;n.lastMatch=e,o={};if(t.names){r=t.pattern.exec(e).slice(1),f=t.names;for(i=u=0,a=f.length;u<a;i=++u)s=f[i],o[s.substring(1)]=r[i]}t.fn(o)},matches:function(e){var t,r,i,s,o;s=n.routes,o=[];for(r=0,i=s.length;r<i;r++)t=s[r],n.isMatch(e,t)&&o.push(t);return o},test:function(e){var t,r,i,s;r=n.matches(e);if(r.length<=0)return;for(i=0,s=r.length;i<s;i++)t=r[i],n.triggerMatch(e,t)}},typeof window.onhashchange!="undefined"?(n.hash=e,window.onhashchange=function(){return n.hash.trigger(n.hash.value())}):(n.hash=t,setTimeout(n.hash.check,100)),n.hash.listen(n.test),n.hash.check&&n.hash.check(),window.rooter=n}).call(this);